<section class="content">
  <div class="content-block">
    <div class="block-header">
      <!-- breadcrumb -->
      <app-breadcrumb [title]="'Book Appointment'" [items]="['Appointment']" [active_item]="'Book'"></app-breadcrumb>
    </div>
    <div class="row clearfix">
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Book Appointment</mat-card-title>
            <mat-card-subtitle class="card-subtitle">Fill in the details to schedule a patient
              appointment</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <form class="m-4" [formGroup]="bookingForm" (ngSubmit)="onSubmit()">
              <!-- Patient Information Section -->
              <div class="mb-4">
                <h3 class="section-title"><i class="material-icons-outlined">person</i> Patient Information</h3>
                <div class="row">
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>First name</mat-label>
                      <input matInput formControlName="first" required>
                      @if (bookingForm.get('first')?.hasError('required')) {
                      <mat-error>
                        First name is required
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Middle name</mat-label>
                      <input matInput formControlName="middle">
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Last name</mat-label>
                      <input matInput formControlName="last">
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Gender</mat-label>
                      <mat-select formControlName="gender" required>
                        <mat-option [value]="'male'">
                          Male
                        </mat-option>
                        <mat-option [value]="'female'">
                          Female
                        </mat-option>
                        <mat-option [value]="'other'">
                          Other
                        </mat-option>
                      </mat-select>
                      @if (bookingForm.get('gender')?.hasError('required')) {
                      <mat-error>
                        Gender is required
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Date Of Birth</mat-label>
                      <input matInput [matDatepicker]="picker" formControlName="dob" required>
                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>
                      @if (bookingForm.get('dob')?.hasError('required')) {
                      <mat-error>
                        Please select date
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Blood Group</mat-label>
                      <mat-select formControlName="bloodGroup">
                        @for (group of bloodGroups; track group) {
                        <mat-option [value]="group">{{group}}</mat-option>
                        }
                        <mat-option [value]="'unknown'">Unknown</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Mobile</mat-label>
                      <input matInput formControlName="mobile" type="number" required>
                      @if (bookingForm.get('mobile')?.hasError('required')) {
                      <mat-error>
                        Mobile number is required
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Email</mat-label>
                      <input matInput formControlName="email" required>
                      @if (bookingForm.get('email')?.hasError('email') && bookingForm.get('email')?.touched) {
                      <mat-error>
                        Please enter a valid email address
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Patient ID (if existing)</mat-label>
                      <input matInput formControlName="patientId">
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Address</mat-label>
                      <textarea matInput formControlName="address" rows="2"></textarea>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <!-- Insurance Information Section -->
              <div class="mb-4">
                <h3 class="section-title"><i class="material-icons-outlined">health_and_safety</i> Insurance Information
                </h3>
                <div class="row">
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Insurance Provider</mat-label>
                      <input matInput formControlName="insuranceProvider">
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Policy Number</mat-label>
                      <input matInput formControlName="policyNumber">
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Group Number</mat-label>
                      <input matInput formControlName="groupNumber">
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Insurance Holder Name (if not patient)</mat-label>
                      <input matInput formControlName="insuranceHolderName">
                    </mat-form-field>
                  </div>
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Relationship to Patient</mat-label>
                      <mat-select formControlName="relationshipToPatient">
                        @for (relation of relationships; track relation) {
                        <mat-option [value]="relation.toLowerCase()">{{relation}}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <!-- Medical History Section -->
              <div class="mb-4">
                <h3 class="section-title"><i class="material-icons-outlined">history</i> Medical History</h3>
                <div class="row">
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Existing Medical Conditions</mat-label>
                      <textarea matInput formControlName="medicalConditions" rows="2"
                        placeholder="Diabetes, Hypertension, etc."></textarea>
                    </mat-form-field>
                  </div>
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Current Medications</mat-label>
                      <textarea matInput formControlName="currentMedications" rows="2"
                        placeholder="List all current medications"></textarea>
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Allergies</mat-label>
                      <textarea matInput formControlName="allergies" rows="2"
                        placeholder="Medications, food, etc."></textarea>
                    </mat-form-field>
                  </div>
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Previous Surgeries</mat-label>
                      <textarea matInput formControlName="previousSurgeries" rows="2"
                        placeholder="Type and date of surgery"></textarea>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <!-- Emergency Contact Section -->
              <div class="mb-4">
                <h3 class="section-title"><i class="material-icons-outlined">emergency</i> Emergency Contact</h3>
                <div class="row">
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Contact Name</mat-label>
                      <input matInput formControlName="emergencyContactName">
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Relationship</mat-label>
                      <mat-select formControlName="emergencyContactRelationship">
                        @for (relation of relationships; track relation) {
                        <mat-option [value]="relation.toLowerCase()">{{relation}}</mat-option>
                        }
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Contact Phone</mat-label>
                      <input matInput formControlName="emergencyContactPhone" type="number">
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <!-- Appointment Details Section -->
              <div class="mb-4">
                <h3 class="section-title"><i class="material-icons-outlined">event</i> Appointment Details</h3>
                <div class="row">
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Department</mat-label>
                      <mat-select formControlName="department" required>
                        @for (dept of departments; track dept) {
                        <mat-option [value]="dept.toLowerCase()">{{dept}}</mat-option>
                        }
                      </mat-select>
                      @if (bookingForm.get('department')?.hasError('required')) {
                      <mat-error>
                        Department is required
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Consulting Doctor</mat-label>
                      <mat-select formControlName="doctor" required>
                        <mat-option [value]="'Dr.Rajesh'">
                          Dr.Rajesh
                        </mat-option>
                        <mat-option [value]="'Dr.Sarah Smith'">
                          Dr.Sarah Smith
                        </mat-option>
                        <mat-option [value]="'Dr.Jay Soni'">
                          Dr.Jay Soni
                        </mat-option>
                        <mat-option [value]="'Dr.Pooja Patel'">
                          Dr.Pooja Patel
                        </mat-option>
                        <mat-option [value]="'other'">
                          Other
                        </mat-option>
                      </mat-select>
                      @if (bookingForm.get('doctor')?.hasError('required')) {
                      <mat-error>
                        Select Any Doctor
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Appointment Type</mat-label>
                      <mat-select formControlName="appointmentType" required>
                        @for (type of appointmentTypes; track type) {
                        <mat-option [value]="type.value">{{type.viewValue}}</mat-option>
                        }
                      </mat-select>
                      @if (bookingForm.get('appointmentType')?.hasError('required')) {
                      <mat-error>
                        Appointment type is required
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Date Of Appointment</mat-label>
                      <input matInput [matDatepicker]="picker1" formControlName="doa" required>
                      <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                      <mat-datepicker #picker1></mat-datepicker>
                      @if (bookingForm.get('doa')?.hasError('required')) {
                      <mat-error>
                        Please select a date
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                  <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Reason for Visit</mat-label>
                      <textarea matInput formControlName="visitReason" required></textarea>
                      @if (bookingForm.get('visitReason')?.hasError('required')) {
                      <mat-error>
                        Reason for visit is required
                      </mat-error>
                      }
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <label class="time-slot-label">Time Of Appointment:</label>
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                    <mat-button-toggle-group name="timeSlot" aria-label="Time Slot" class="mb-5 time-slot-group"
                      formControlName="timeSlot">
                      <div class="time-slot-section">
                        <h4 class="time-slot-header">Morning</h4>
                        @for (slot of morningSlots; track slot; let i = $index) {
                        <mat-button-toggle [value]="'morning_' + i">{{slot}}</mat-button-toggle>
                        }
                      </div>
                      <div class="time-slot-section">
                        <h4 class="time-slot-header">Afternoon</h4>
                        @for (slot of afternoonSlots; track slot; let i = $index) {
                        <mat-button-toggle [value]="'afternoon_' + i">{{slot}}</mat-button-toggle>
                        }
                      </div>
                      <div class="time-slot-section">
                        <h4 class="time-slot-header">Evening</h4>
                        @for (slot of eveningSlots; track slot; let i = $index) {
                        <mat-button-toggle [value]="'evening_' + i">{{slot}}</mat-button-toggle>
                        }
                      </div>
                    </mat-button-toggle-group>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Symptoms/Condition</mat-label>
                      <textarea matInput formControlName="injury"></textarea>
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                      <mat-label>Additional Notes</mat-label>
                      <textarea matInput formControlName="note"></textarea>
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-5">
                    <label>Upload Previous Medical Reports</label>
                    <app-file-upload formControlName="uploadFile"></app-file-upload>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3 text-end">
                  <button type="button" mat-raised-button class="formCancelBtn me-2" (click)="resetForm()">
                    <mat-icon class="material-icons-outlined">refresh</mat-icon> Reset Form
                  </button>
                  <button class="btn-space" [disabled]="!bookingForm.valid" mat-flat-button color="primary"
                    type="submit">
                    <mat-icon class="material-icons-outlined">check_circle</mat-icon> Submit Appointment
                  </button>
                </div>
              </div>
            </form>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</section>