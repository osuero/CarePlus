<section class="content">
  <div class="content-block">
    <div class="block-header">
      <!-- breadcrumb -->
      <app-breadcrumb [title]="'New Allotment'" [items]="['Room']" [active_item]="'New Allotment'"></app-breadcrumb>
    </div>
    <div class="row clearfix">
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>New Room Allotment</h2>
          </div>
          <div class="body">
            <form class="m-4" [formGroup]="roomForm">
              <div class="row">
                <div class="col-12">
                  <h3 class="section-title"><i class="material-icons-outlined">account_circle</i> Patient Details</h3>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Patient Name</mat-label>
                    <input matInput formControlName="patientName" required>
                    @if (hasError('patientName', 'required')) {
                      <mat-error>Patient Name is required</mat-error>
                    }
                    @if (hasError('patientName', 'minlength')) {
                      <mat-error>Name must be at least 3 characters</mat-error>
                    }
                  </mat-form-field>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Patient ID</mat-label>
                    <input matInput formControlName="patientId" required>
                    @if (hasError('patientId', 'required')) {
                      <mat-error>Patient ID is required</mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Age</mat-label>
                    <input matInput type="number" formControlName="age" required min="0" max="120">
                    @if (hasError('age', 'required')) {
                      <mat-error>Age is required</mat-error>
                    }
                    @if (hasError('age', 'min') || hasError('age', 'max')) {
                      <mat-error>Age must be between 0 and 120</mat-error>
                    }
                  </mat-form-field>
                </div>
                <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Gender</mat-label>
                    <mat-select formControlName="gender" required>
                      @for (option of genderOptions; track option) {
                        <mat-option [value]="option.value">{{option.viewValue}}</mat-option>
                      }
                    </mat-select>
                    @if (hasError('gender', 'required')) {
                      <mat-error>Gender is required</mat-error>
                    }
                  </mat-form-field>
                </div>
                <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-3">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Mobile</mat-label>
                    <input matInput formControlName="mobile" required>
                    @if (hasError('mobile', 'required')) {
                      <mat-error>Mobile Number is required</mat-error>
                    }
                    @if (hasError('mobile', 'pattern')) {
                      <mat-error>Enter a valid 10-digit mobile number</mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Email</mat-label>
                    <input matInput formControlName="email" required>
                    @if (hasError('email', 'required')) {
                      <mat-error>Email is required</mat-error>
                    }
                    @if (hasError('email', 'email')) {
                      <mat-error>Enter a valid email address</mat-error>
                    }
                  </mat-form-field>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Emergency Contact</mat-label>
                    <input matInput formControlName="emergencyContact">
                    @if (hasError('emergencyContact', 'pattern')) {
                      <mat-error>Enter a valid 10-digit mobile number</mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Medical History</mat-label>
                    <textarea matInput formControlName="medicalHistory" rows="3"></textarea>
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Allergies</mat-label>
                    <textarea matInput formControlName="allergies" rows="2"></textarea>
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-12">
                  <h3 class="section-title"><i class="material-icons-outlined">meeting_room</i> Room Details</h3>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Room No</mat-label>
                    <input matInput formControlName="roomNo" required>
                    @if (hasError('roomNo', 'required')) {
                      <mat-error>Room Number is required</mat-error>
                    }
                  </mat-form-field>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Room Type</mat-label>
                    <mat-select formControlName="roomType" required>
                      @for (option of roomTypeOptions; track option) {
                        <mat-option [value]="option.value">{{option.viewValue}}</mat-option>
                      }
                    </mat-select>
                    @if (hasError('roomType', 'required')) {
                      <mat-error>Room Type is required</mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Admission Date</mat-label>
                    <input matInput [matDatepicker]="admitDatePicker" formControlName="admitDate" required>
                    <mat-datepicker-toggle matSuffix [for]="admitDatePicker"></mat-datepicker-toggle>
                    <mat-datepicker #admitDatePicker></mat-datepicker>
                    @if (hasError('admitDate', 'required')) {
                      <mat-error>
                        Admission Date is required
                      </mat-error>
                    }
                  </mat-form-field>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Discharge Date</mat-label>
                    <input matInput [matDatepicker]="dischargeDatePicker" formControlName="dischargeDate" required>
                    <mat-datepicker-toggle matSuffix [for]="dischargeDatePicker"></mat-datepicker-toggle>
                    <mat-datepicker #dischargeDatePicker></mat-datepicker>
                    @if (hasError('dischargeDate', 'required')) {
                      <mat-error>
                        Discharge Date is required
                      </mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Doctor Assigned</mat-label>
                    <input matInput formControlName="doctorAssigned" required>
                    @if (hasError('doctorAssigned', 'required')) {
                      <mat-error>Doctor Assigned is required</mat-error>
                    }
                  </mat-form-field>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Status</mat-label>
                    <mat-select formControlName="status" required>
                      @for (option of patientStatusOptions; track option) {
                        <mat-option [value]="option.value">{{option.viewValue}}</mat-option>
                      }
                    </mat-select>
                    @if (hasError('status', 'required')) {
                      <mat-error>Status is required</mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Amount Charged</mat-label>
                    <input matInput type="number" formControlName="amountCharged" required min="0">
                    @if (hasError('amountCharged', 'required')) {
                      <mat-error>Amount Charged is required</mat-error>
                    }
                    @if (hasError('amountCharged', 'min')) {
                      <mat-error>Amount must be a positive number</mat-error>
                    }
                  </mat-form-field>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Notes</mat-label>
                    <textarea matInput formControlName="notes" rows="1"></textarea>
                  </mat-form-field>
                </div>
              </div>

              <div class="row mt-4">
                <div class="col-12">
                  <button mat-flat-button color="primary" type="submit" (click)="onSubmit()"
                    [disabled]="roomForm.invalid || isSubmitting" class="me-2">
                    <mat-icon>save</mat-icon> Submit
                    @if (isSubmitting) {
                      <mat-icon class="ms-2">hourglass_empty</mat-icon>
                    }
                  </button>
                  <button mat-stroked-button type="button" (click)="resetForm()">
                    <mat-icon>refresh</mat-icon> Reset
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>